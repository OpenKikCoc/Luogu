#  [NOIP2003 普及组 麦森数](https://www.luogu.com.cn/problem/P1045)

## 题意

>   ## 题目描述
>
>   形如2P−12*P*−1的素数称为麦森数，这时P*P*一定也是个素数。但反过来不一定，即如果P*P*是个素数，2P−12*P*−1不一定也是素数。到1998年底，人们已找到了37个麦森数。最大的一个是P=3021377*P*=3021377，它有909526位。麦森数有许多重要应用，它与完全数密切相关。
>
>   任务：从文件中输入P*P*（1000<P<31000001000<*P*<3100000），计算2P−12*P*−1的位数和最后500位数字（用十进制高精度数表示）
>
>   ## 输入格式
>
>   文件中只包含一个整数P*P*（1000<P<31000001000<*P*<3100000）
>
>   ## 输出格式
>
>   第一行：十进制高精度数2P−12*P*−1的位数。
>
>   第2-11行：十进制高精度数2P−12*P*−1的最后500位数字。（每行输出50位，共输出10行，不足500位时高位补0）
>
>   不必验证2P−12*P*−1与P*P*是否为素数。
>
>   ## 输入输出样例
>
>   **输入 #1**复制
>
>   ```
>   1279
>   ```
>
>   **输出 #1**复制
>
>   ```
>   386
>   00000000000000000000000000000000000000000000000000
>   00000000000000000000000000000000000000000000000000
>   00000000000000104079321946643990819252403273640855
>   38615262247266704805319112350403608059673360298012
>   23944173232418484242161395428100779138356624832346
>   49081399066056773207629241295093892203457731833496
>   61583550472959420547689811211693677147548478866962
>   50138443826029173234888531116082853841658502825560
>   46662248318909188018470682222031405210266984354887
>   32958028878050869736186900714720710555703168729087
>   ```
>
>   ## 说明/提示
>
>   **【题目来源】**
>
>   NOIP 2003 普及组第四题

## 题解



```c++
#include <bits/stdc++.h>
using namespace std;

// 考虑 2^p - 1 与 2^p 位数相同，故不直接计算 2 ^ p;
// [2^p 没有 5 这个因数故尾数不为 0 ]

const int N = 510;

int d[N], c[N], res[N];

void mul(int a[N], int b[N], int res[N]) {
    memset(c, 0, N * 4);
    for (int i = 0; i < 500; i ++ )
        for (int j = 0; j < 500; j ++ )
            if (i + j < 500)
                c[i + j] += a[i] * b[j];
    for (int i = 0, t = 0; i < 500; i ++ ) {
        t += c[i];
        res[i] = t % 10;
        t /= 10;
    }
}

void qmi(int p)
{
    res[0] = 1;
    d[0] = 2;
    while (p) {
        if (p & 1)
            mul(d, res, res);
        mul(d, d, d);
        p >>= 1;
    }
    res[0] -- ;
}

int main() {
    int p;
    cin >> p;
    
    // Q1
    cout << int(p * log10(2.0) + 1) << endl;
    
    // Q2
    qmi(p);
    
    for (int i = 499, j = 0; j < 10; j ++ ) {
        for (int k = 0; k < 50; k ++, i -- )
            printf("%d", res[i]);
        puts("");
    }
    
    return 0;
}
```



```python3

```

